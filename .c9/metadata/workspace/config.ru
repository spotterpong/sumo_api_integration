{"filter":false,"title":"config.ru","tooltip":"/config.ru","undoManager":{"mark":14,"position":14,"stack":[[{"start":{"row":0,"column":0},"end":{"row":89,"column":24},"action":"insert","lines":["Lets Build a Sinatra App","Featured in issue #156 of Ruby Weekly.","","Lets talk a little bit about my motivation for this article. Frustration… Frustration with what you ask? Apple TV, AirPlay & watching videos from my library. Normally when I think apple, I think: beauty, simplicity, it just works… You know, the same things that come to mind when anyone thinks of apple. I also love watching Seinfeld before I hit the sack. Its how I switch gears from mad coder to heavy sleeper.","","My setup is pretty simple, all my videos are stored on my time capsule. I have a Mac mini with iTunes. I connect via my iPad that sits on my nightstand. Everything has been amazing, that is, until a few months ago. I don’t know what changed but one night I fired up the videos app on my iPad, and waited for it to find the Mac mini library. It didnt… So I get up, go to the Mac mini and make sure it is connected to the network and to the shared drive. Try again, it works. I’d keep running into the same issue every night though. I mean, what good is it if it doesn’t just work? amirite?","","So at this point you might be saying “I thought this was a post about Sinatra?” or maybe I already lost a few of you. So before I lose any more of you, “Let’s get the show on the road!”.","","I have to make a few assumptions here in order to keep this a blog post. One is that you know what Sinatra is. If you don’t I’ll borrow this brief quote from the Sinatra site: “Sinatra is a DSL for quickly creating web applications in Ruby with minimal effort”. The next assumption I am going to make is that you are already a developer and just want a quick jumpstart in building your first sinatra app. So you should already have ruby installed on your machine.","","I’ll start by modeling the app a bit. For now just the basics. I am going to have a video object with fields like title, length, description, image & genre. I’ll need a storage location. I’ll need a way to add this info about the video, upload the video, and watch it, especially on my iPad.","","A few things to note, I am developing and running this from my Mac. I believe everything should work just the same on Linux, though I’m not so sure about Windows. I will be using haml for the markup. So instead of having to type out this:","","<section class=”container”>","  <h1><%= post.title %></h1>","  <h2><%= post.subtitle %></h2>","  <div class=”content”>","    <%= post.content %>","  </div>","</section>","we can just type this:","","%section.container","  %h1= post.title","  %h2= post.subtitle","  .content","    = post.content","Time to kick things off, we need to open terminal and install a few things. If you’re not comfortable on the commandline I’d suggest you read up on basics. You should still be able to follow along, but if your goal is to be a developer you should really have a basic understanding. If you have a few hours and about $24, a great resource is the “Meet the Command Line” videos over at PeepCode.","","https://peepcode.com/products/meet-the-command-line","https://peepcode.com/products/advanced-command-line","Now we’re going to put the app structure and basic setup in place. From a directory that makes sense (in my case I have a /Users/mweppler/developer/projects directory that I keep all my projects in) run the following:","","mkdir -p the-video-store the-video-store/public the-video-store/public/images the-video-store/public/javascripts the-video-store/public/media/image the-video-store/public/media/video the-video-store/public/stylesheets the-video-store/views the-video-store/media/image the-video-store/media/video","","touch the-video-store/config.ru the-video-store/config.yml the-video-store/Gemfile the-video-store/video_store.rb the-video-store/views/index.haml the-video-store/views/layout.haml","You should now have the following structure:","",".","├── media/","│   ├── image/","│   └── video/","├── public/","│   ├── images/","│   ├── javascripts/","│   ├── media/","│   │   ├── image/","│   │   └── video/","│   └── stylesheets/","├── views/","│   ├── index.haml","│   └── layout.haml","├── Gemfile","├── config.ru","├── config.yml","└── video_store.rb","","11 directories, 6 files","Raise your hand if you know what a “Gemfile” is. Ok now put your hand down. Since I couldn’t see if you had your hand raised or not I’ll just assume you did and proceed with adding some gems to our Gemfile. Note: If you don’t know what a gem file is you’ve got some more reading to do pal. Start by checking out the Bundler site.","","source \"https://rubygems.org\"","","gem 'capistrano', '2.14.2'","gem 'data_mapper', '1.2.0'","gem 'dm-core', '1.2.0'","gem 'dm-sqlite-adapter', '1.2.0'","gem 'dm-timestamps', '1.2.0'","gem 'haml', '3.1.7'","gem 'sass', '3.2.1'","gem 'shotgun', '0.9'","gem 'sinatra', '1.3.5'","gem 'sqlite3', '1.3.7'","…and from the commandline, run bundler:","","bundle install","I want to get this basic app up and running quickly so we can iterate through the functionality. Normally I’d suggest you follow TDD/BDD practices but for something this basic I want to focus on sinatra. Add the following to your config.ru file:","","require 'rubygems'","require 'bundler/setup'","require 'sinatra'","require 'haml'","require './video_store'","","set :environment, :development","set :run, false","set :raise_errors, true","","run Sinatra::Application"],"id":1}],[{"start":{"row":83,"column":11},"end":{"row":83,"column":22},"action":"remove","lines":["video_store"],"id":2},{"start":{"row":83,"column":11},"end":{"row":83,"column":12},"action":"insert","lines":["m"]}],[{"start":{"row":83,"column":12},"end":{"row":83,"column":13},"action":"insert","lines":["a"],"id":3}],[{"start":{"row":83,"column":13},"end":{"row":83,"column":14},"action":"insert","lines":["i"],"id":4}],[{"start":{"row":83,"column":14},"end":{"row":83,"column":15},"action":"insert","lines":["n"],"id":5}],[{"start":{"row":73,"column":0},"end":{"row":78,"column":0},"action":"remove","lines":["gem 'sqlite3', '1.3.7'","…and from the commandline, run bundler:","","bundle install","I want to get this basic app up and running quickly so we can iterate through the functionality. Normally I’d suggest you follow TDD/BDD practices but for something this basic I want to focus on sinatra. Add the following to your config.ru file:",""],"id":6}],[{"start":{"row":65,"column":0},"end":{"row":68,"column":28},"action":"remove","lines":["gem 'data_mapper', '1.2.0'","gem 'dm-core', '1.2.0'","gem 'dm-sqlite-adapter', '1.2.0'","gem 'dm-timestamps', '1.2.0'"],"id":7}],[{"start":{"row":64,"column":26},"end":{"row":65,"column":0},"action":"remove","lines":["",""],"id":8}],[{"start":{"row":64,"column":25},"end":{"row":64,"column":26},"action":"remove","lines":["'"],"id":9}],[{"start":{"row":64,"column":24},"end":{"row":64,"column":25},"action":"remove","lines":["2"],"id":10}],[{"start":{"row":64,"column":23},"end":{"row":64,"column":24},"action":"remove","lines":["."],"id":11}],[{"start":{"row":63,"column":0},"end":{"row":64,"column":23},"action":"remove","lines":["","gem 'capistrano', '2.14"],"id":12}],[{"start":{"row":0,"column":0},"end":{"row":61,"column":0},"action":"remove","lines":["Lets Build a Sinatra App","Featured in issue #156 of Ruby Weekly.","","Lets talk a little bit about my motivation for this article. Frustration… Frustration with what you ask? Apple TV, AirPlay & watching videos from my library. Normally when I think apple, I think: beauty, simplicity, it just works… You know, the same things that come to mind when anyone thinks of apple. I also love watching Seinfeld before I hit the sack. Its how I switch gears from mad coder to heavy sleeper.","","My setup is pretty simple, all my videos are stored on my time capsule. I have a Mac mini with iTunes. I connect via my iPad that sits on my nightstand. Everything has been amazing, that is, until a few months ago. I don’t know what changed but one night I fired up the videos app on my iPad, and waited for it to find the Mac mini library. It didnt… So I get up, go to the Mac mini and make sure it is connected to the network and to the shared drive. Try again, it works. I’d keep running into the same issue every night though. I mean, what good is it if it doesn’t just work? amirite?","","So at this point you might be saying “I thought this was a post about Sinatra?” or maybe I already lost a few of you. So before I lose any more of you, “Let’s get the show on the road!”.","","I have to make a few assumptions here in order to keep this a blog post. One is that you know what Sinatra is. If you don’t I’ll borrow this brief quote from the Sinatra site: “Sinatra is a DSL for quickly creating web applications in Ruby with minimal effort”. The next assumption I am going to make is that you are already a developer and just want a quick jumpstart in building your first sinatra app. So you should already have ruby installed on your machine.","","I’ll start by modeling the app a bit. For now just the basics. I am going to have a video object with fields like title, length, description, image & genre. I’ll need a storage location. I’ll need a way to add this info about the video, upload the video, and watch it, especially on my iPad.","","A few things to note, I am developing and running this from my Mac. I believe everything should work just the same on Linux, though I’m not so sure about Windows. I will be using haml for the markup. So instead of having to type out this:","","<section class=”container”>","  <h1><%= post.title %></h1>","  <h2><%= post.subtitle %></h2>","  <div class=”content”>","    <%= post.content %>","  </div>","</section>","we can just type this:","","%section.container","  %h1= post.title","  %h2= post.subtitle","  .content","    = post.content","Time to kick things off, we need to open terminal and install a few things. If you’re not comfortable on the commandline I’d suggest you read up on basics. You should still be able to follow along, but if your goal is to be a developer you should really have a basic understanding. If you have a few hours and about $24, a great resource is the “Meet the Command Line” videos over at PeepCode.","","https://peepcode.com/products/meet-the-command-line","https://peepcode.com/products/advanced-command-line","Now we’re going to put the app structure and basic setup in place. From a directory that makes sense (in my case I have a /Users/mweppler/developer/projects directory that I keep all my projects in) run the following:","","mkdir -p the-video-store the-video-store/public the-video-store/public/images the-video-store/public/javascripts the-video-store/public/media/image the-video-store/public/media/video the-video-store/public/stylesheets the-video-store/views the-video-store/media/image the-video-store/media/video","","touch the-video-store/config.ru the-video-store/config.yml the-video-store/Gemfile the-video-store/video_store.rb the-video-store/views/index.haml the-video-store/views/layout.haml","You should now have the following structure:","",".","├── media/","│   ├── image/","│   └── video/","├── public/","│   ├── images/","│   ├── javascripts/","│   ├── media/","│   │   ├── image/","│   │   └── video/","│   └── stylesheets/","├── views/","│   ├── index.haml","│   └── layout.haml","├── Gemfile","├── config.ru","├── config.yml","└── video_store.rb","","11 directories, 6 files","Raise your hand if you know what a “Gemfile” is. Ok now put your hand down. Since I couldn’t see if you had your hand raised or not I’ll just assume you did and proceed with adding some gems to our Gemfile. Note: If you don’t know what a gem file is you’ve got some more reading to do pal. Start by checking out the Bundler site.",""],"id":13}],[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"remove","lines":["",""],"id":14}],[{"start":{"row":0,"column":0},"end":{"row":6,"column":0},"action":"remove","lines":["source \"https://rubygems.org\"","","gem 'haml', '3.1.7'","gem 'sass', '3.2.1'","gem 'shotgun', '0.9'","gem 'sinatra', '1.3.5'",""],"id":15}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":0,"column":0},"end":{"row":0,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1463081182690,"hash":"f4c10da386b8c388d73b3e413e7c4cab4415b92f"}